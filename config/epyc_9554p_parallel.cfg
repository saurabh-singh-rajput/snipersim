# Fast Parallel Configuration for AMD EPYC 9554P - Optimized for MPI/parallel validation
# Maintains energy modeling accuracy while optimizing for parallel execution speed

[general]
arch = intel
mode = 64
magic = false
roi_script = false
inst_mode_init = cache_only
inst_mode_roi = cache_only    # Changed from detailed for speed
inst_mode_end = fast_forward
inst_mode_output = true       # Keep output for energy analysis
syntax = intel
issue_memops_at_functional = false
num_host_cores = 0
enable_signals = false
signals_to_ignore = 13
enable_smc_support = false
enable_pinplay = false
enable_syscall_emulation = true
suppress_stdout = false
suppress_stderr = false

# Moderate core count for parallel execution while maintaining energy accuracy
total_cores = 16

enable_icache_modeling = true

[log]
enabled = false
stack_trace = false
disabled_modules = ""
enabled_modules = ""
mutex_trace = false
pin_codecache_trace = false
circular_log = false

[progress_trace]
enabled = false
interval = 5000
filename = ""

[clock_skew_minimization]
scheme = barrier
report = false

[clock_skew_minimization/barrier]
quantum = 1000                # Increased from 100 for better parallel performance

# Core model - balanced for speed and energy accuracy
[perf_model/core]
frequency = 2.4               # Base frequency of EPYC 9554P
type = interval               # Keep interval for energy modeling
core_model = nehalem
logical_cpus = 2              # Keep SMT for accuracy

# Optimized interval timer model
[perf_model/core/interval_timer]
dispatch_width = 4            # Reduced from 6 for speed
window_size = 96              # Reduced from 192 for speed
issue_contention = true
num_outstanding_loadstores = 16
memory_dependency_granularity = 8
lll_dependency_granularity = 64
lll_cutoff = 30
issue_memops_at_dispatch = false

# Instruction costs - kept for energy accuracy
[perf_model/core/static_instruction_costs]
add=1
sub=1
mul=3
div=18
fadd=3
fsub=3
fmul=5
fdiv=6
generic=1
jmp=1
string=1
branch=1
dynamic_misc=1
recv=1
sync=0
spawn=0
tlb_miss=0
mem_access=0
delay=0
unknown=0

# Simplified branch predictor for speed
[perf_model/branch_predictor]
type=one_bit                  # Simplified from pentium_m
mispredict_penalty=16
size=1024                     # Reduced from 4096

# Simplified TLB for speed
[perf_model/tlb]
penalty = 15                  # Reduced from 30
penalty_parallel = true

[perf_model/itlb]
size = 32                     # Reduced from 64
associativity = 4

[perf_model/dtlb]
size = 32                     # Reduced from 64
associativity = 4

[perf_model/stlb]
size = 256                    # Reduced from 512
associativity = 4

# Cache hierarchy - maintained for energy accuracy
[perf_model/cache]
levels = 3

# L1 Instruction Cache - kept accurate for energy modeling
[perf_model/l1_icache]
perfect = false
cache_size = 32
cache_block_size = 64
associativity = 8
address_hash = mask
replacement_policy = lru
data_access_time = 2          # Reduced from 4
tags_access_time = 1
perf_model_type = parallel
writethrough = 0
shared_cores = 1

# L1 Data Cache - kept accurate for energy modeling
[perf_model/l1_dcache]
perfect = false
cache_size = 32
associativity = 8
address_hash = mask
replacement_policy = lru
data_access_time = 2          # Reduced from 4
tags_access_time = 1
perf_model_type = parallel
writethrough = 0
shared_cores = 1

# L2 Cache - kept accurate
[perf_model/l2_cache]
perfect = false
cache_size = 1024
associativity = 8
address_hash = mask
replacement_policy = lru
data_access_time = 8          # Reduced from 12
tags_access_time = 2          # Reduced from 3
perf_model_type = parallel
writethrough = 0
shared_cores = 1

# L3 Cache - proportionally sized for 16 cores
[perf_model/l3_cache]
cache_block_size = 64
cache_size = 65536            # 64MB for 16 cores (262144/4)
associativity = 16
address_hash = mask
replacement_policy = lru
dvfs_domain = global
prefetcher = none
writeback_time = 0
shared_cores = 16             # Shared across 16 cores
writethrough = 0
perf_model_type = parallel
tags_access_time = 8          # Reduced from 12
data_access_time = 35         # Reduced from 50

[perf_model/fast_forward]
model = oneipc
interval = 100000
include_memory_latency = true
include_branch_misprediction = false

[core]
spin_loop_detection = false

[core/light_cache]
num = 0

[core/cheetah]
enabled = false
min_size_bits = 10
max_size_bits_local = 30
max_size_bits_global = 36

[core/hook_periodic_ins]
ins_per_core = 10000
ins_global = 1000000

[caching_protocol]
type = parametric_dram_directory_msi
variant = mesi

# DRAM directory - scaled for 16 cores
[perf_model/dram_directory]
total_entries = 262144         # Reduced from 1048576
associativity = 16
max_hw_sharers = 16            # Reduced from 64
directory_type = full_map
home_lookup_param = 6
directory_cache_access_time = 10
locations = dram
interleaving = 1

[perf_model/dram_directory/limitless]
software_trap_penalty = 200

# DRAM configuration
[perf_model/dram]
type = constant
latency = 80
per_controller_bandwidth = 25.6
num_controllers = -1
controllers_interleaving = 16  # Updated for 16 cores
controller_positions = ""
direct_access = false

[perf_model/dram/normal]
standard_deviation = 0

[perf_model/dram/cache]
enabled = false

[perf_model/dram/queue_model]
enabled = true
type = history_list

[perf_model/nuca]
enabled = false

[perf_model/sync]
reschedule_cost = 1000

# Network configuration
[network]
memory_model_1 = emesh_hop_counter
system_model = emesh_hop_counter
collect_traffic_matrix = false

[network/emesh_hop_counter]
link_bandwidth = 128
hop_latency = 1

[network/emesh_hop_by_hop]
link_bandwidth = 128
hop_latency = 1
concentration = 1
dimensions = 2
wrap_around = false
size = ""

[network/emesh_hop_by_hop/queue_model]
enabled = true
type = history_list

[network/emesh_hop_by_hop/broadcast_tree]
enabled = false

[network/bus]
ignore_local_traffic = true

[network/bus/queue_model]
type=contention

[queue_model/basic]
moving_avg_enabled = true
moving_avg_window_size = 1024
moving_avg_type = arithmetic_mean

[queue_model/history_list]
max_list_size = 100
analytical_model_enabled = true

[queue_model/windowed_mg1]
window_size = 1000

# DVFS configuration
[dvfs]
type = simple
transition_latency = 1000

[dvfs/simple]
cores_per_socket = 16          # Updated for 16 cores

[bbv]
sampling = 0

[loop_tracer]
iter_start = 0
iter_count = 36

[osemu]
pthread_replace = false
nprocs = 0
clock_replace = true
time_start = 1337000000

[traceinput]
enabled = false
address_randomization = false
stop_with_first_app = true
restart_apps = false
mirror_output = false
trace_prefix = ""
num_runs = 1
timeout = 360

# Scheduler
[scheduler]
type = pinned

[scheduler/pinned]
quantum = 1000000
core_mask = 1
interleaving = 1

[scheduler/roaming]
quantum = 1000000
core_mask = 1

[scheduler/static]
core_mask = 1

[scheduler/big_small]
quantum = 1000000
debug = false

[hooks]
numscripts = 0

[fault_injection]
type = none
injector = none

[routine_tracer]
type = none

[instruction_tracer]
type = none

[sampling]
enabled = false

# Power modeling configuration for AMD EPYC 9554P (Zen 4)
[power]
vdd = 0.9
technology_node = 45