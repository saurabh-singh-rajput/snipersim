# Optimized EPYC 9554P configuration for fast simulation with energy accuracy
# Based on epyc_9554p.cfg but optimized for single-threaded workloads

[general]
arch = intel
mode = 64
magic = false
roi_script = false
inst_mode_init = cache_only
inst_mode_roi = cache_only    # Changed from detailed for speed
inst_mode_end = fast_forward
inst_mode_output = true       # Keep output for energy analysis
syntax = intel
issue_memops_at_functional = false
num_host_cores = 0
enable_signals = false
signals_to_ignore = 13
enable_smc_support = false
enable_pinplay = false
enable_syscall_emulation = true
suppress_stdout = false
suppress_stderr = false

# Total number of cores in the simulation - reduced for single-threaded workloads
total_cores = 4

enable_icache_modeling = true   # Keep for energy accuracy

[log]
enabled = false
stack_trace = false
disabled_modules = ""
enabled_modules = ""
mutex_trace = false
pin_codecache_trace = false
circular_log = false

[progress_trace]
enabled = false
interval = 5000
filename = ""

[clock_skew_minimization]
scheme = barrier
report = false

[clock_skew_minimization/barrier]
quantum = 1000  # Increased from 100 to 1000 for better performance

# Core model - balanced for speed and energy accuracy
[perf_model/core]
frequency = 3.2              # Use base frequency for energy accuracy
type = interval              # Keep interval for energy modeling
core_model = nehalem
logical_cpus = 1             # Single thread per core

# Simplified interval timer model
[perf_model/core/interval_timer]
dispatch_width = 4           # Reduced from 6 for speed
window_size = 64             # Reduced from 192 for speed
issue_contention = true
num_outstanding_loadstores = 8
memory_dependency_granularity = 8
lll_dependency_granularity = 64
lll_cutoff = 30
issue_memops_at_dispatch = false

# Instruction costs - kept for energy accuracy
[perf_model/core/static_instruction_costs]
add=1
sub=1
mul=3
div=18
fadd=3
fsub=3
fmul=5
fdiv=6
generic=1
jmp=1
string=1
branch=1
dynamic_misc=1
recv=1
sync=0
spawn=0
tlb_miss=0
mem_access=0
delay=0
unknown=0

# Cache hierarchy - simplified for speed
[perf_model/cache]
levels = 3

# L1 Instruction Cache - simplified
[perf_model/l1_icache]
perfect = false
cache_size = 32
cache_block_size = 64
associativity = 8
address_hash = mask
replacement_policy = lru
data_access_time = 0  # Disable for speed
tags_access_time = 0  # Disable for speed
perf_model_type = parallel
writethrough = 0
shared_cores = 1

# L1 Data Cache - simplified
[perf_model/l1_dcache]
perfect = false
cache_size = 32
associativity = 8
address_hash = mask
replacement_policy = lru
data_access_time = 0  # Disable for speed
tags_access_time = 0  # Disable for speed
perf_model_type = parallel
writethrough = 0
shared_cores = 1

# L2 Cache - simplified
[perf_model/l2_cache]
perfect = false
cache_size = 1024
associativity = 8
address_hash = mask
replacement_policy = lru
data_access_time = 0  # Disable for speed
tags_access_time = 0  # Disable for speed
perf_model_type = parallel
writethrough = 0
shared_cores = 1

# L3 Cache - simplified
[perf_model/l3_cache]
cache_block_size = 64
cache_size = 32768
associativity = 16
address_hash = mask
replacement_policy = lru
dvfs_domain = global
prefetcher = none
writeback_time = 0
shared_cores = 8
writethrough = 0
perf_model_type = parallel
tags_access_time = 0  # Disable for speed
data_access_time = 0  # Disable for speed

# Fast-forward configuration for speed
[perf_model/fast_forward]
model = oneipc
interval = 10000  # 10us intervals for fast-forwarding

[perf_model/fast_forward/oneipc]
interval = 10000
include_memory_latency = false  # Disable for speed
include_branch_misprediction = false  # Disable for speed

# Simplified branch predictor
[perf_model/branch_predictor]
type = none  # Disable for speed

# Simplified TLB
[perf_model/tlb]
penalty = 0  # Disable TLB penalties for speed
penalty_parallel = false

# Disable complex memory modeling
[perf_model/dram]
type = constant
latency = 80
per_controller_bandwidth = 25.6
num_controllers = 1
controllers_interleaving = 8
controller_positions = ""
direct_access = false

[perf_model/dram/normal]
standard_deviation = 0

[perf_model/dram/cache]
enabled = false

[perf_model/dram/queue_model]
enabled = false

# Disable directory cache
[perf_model/dram_directory]
enabled = false

# Simplified network
[network]
memory_model_1 = emesh_hop_counter
system_model = emesh_hop_counter
collect_traffic_matrix = false

[network/emesh_hop_counter]
link_bandwidth = 128
hop_latency = 1

# Disable complex prefetching
[perf_model/prefetcher]
enabled = false

# Disable complex cache coherence
[caching_protocol]
type = parametric_dram_directory_msi
variant = mesi

# DVFS configuration
[dvfs]
type = simple
transition_latency = 1000

[dvfs/simple]
cores_per_socket = 64

# Disable complex features
[bbv]
sampling = 0

[loop_tracer]
iter_start = 0
iter_count = 36

[osemu]
pthread_replace = false
clock_replace = true
nprocs = 0
time_start = 1337000000
