# Balanced EPYC 9554P configuration for accurate energy ranking
# Maintains accuracy while providing moderate speed improvements

[general]
arch = intel
mode = 64
magic = false
roi_script = false
inst_mode_init = cache_only
inst_mode_roi = detailed
inst_mode_end = fast_forward
inst_mode_output = false  # Reduce output overhead
syntax = intel
issue_memops_at_functional = false
num_host_cores = 0
enable_signals = false
signals_to_ignore = 13
enable_smc_support = false
enable_pinplay = false
enable_syscall_emulation = true
suppress_stdout = false
suppress_stderr = false

# Total number of cores in the simulation
total_cores = 64

enable_icache_modeling = true  # Keep for accuracy

[log]
enabled = false
stack_trace = false
disabled_modules = ""
enabled_modules = ""
mutex_trace = false
pin_codecache_trace = false
circular_log = false

[progress_trace]
enabled = false
interval = 5000
filename = ""

[clock_skew_minimization]
scheme = barrier
report = false

[clock_skew_minimization/barrier]
quantum = 500  # Moderate increase for some speed

# Core model - use interval for accuracy but with optimizations
[perf_model/core]
frequency = 1.5
type = interval  # Keep interval for accuracy
core_model = nehalem
logical_cpus = 2

# Interval timer model with some optimizations
[perf_model/core/interval_timer]
dispatch_width = 6
window_size = 192
issue_contention = true
num_outstanding_loadstores = 16
memory_dependency_granularity = 8
lll_dependency_granularity = 64
lll_cutoff = 30
issue_memops_at_dispatch = false

# Cache hierarchy - maintain accuracy
[perf_model/cache]
levels = 3

# L1 Instruction Cache - accurate modeling
[perf_model/l1_icache]
perfect = false
cache_size = 32
cache_block_size = 64
associativity = 8
address_hash = mask
replacement_policy = lru
data_access_time = 4  # Keep accurate timing
tags_access_time = 1  # Keep accurate timing
perf_model_type = parallel
writethrough = 0
shared_cores = 1

# L1 Data Cache - accurate modeling
[perf_model/l1_dcache]
perfect = false
cache_size = 32
associativity = 8
address_hash = mask
replacement_policy = lru
data_access_time = 4  # Keep accurate timing
tags_access_time = 1  # Keep accurate timing
perf_model_type = parallel
writethrough = 0
shared_cores = 1

# L2 Cache - accurate modeling
[perf_model/l2_cache]
perfect = false
cache_size = 1024
associativity = 8
address_hash = mask
replacement_policy = lru
data_access_time = 12  # Keep accurate timing
tags_access_time = 3   # Keep accurate timing
perf_model_type = parallel
writethrough = 0
shared_cores = 1

# L3 Cache - accurate modeling
[perf_model/l3_cache]
cache_block_size = 64
cache_size = 32768
associativity = 16
address_hash = mask
replacement_policy = lru
dvfs_domain = global
prefetcher = none
writeback_time = 0
shared_cores = 8
writethrough = 0
perf_model_type = parallel
tags_access_time = 8   # Keep accurate timing
data_access_time = 40  # Keep accurate timing

# Fast-forward configuration for some speed
[perf_model/fast_forward]
model = oneipc
interval = 100000

[perf_model/fast_forward/oneipc]
interval = 100000
include_memory_latency = true  # Keep for accuracy
include_branch_misprediction = true  # Keep for accuracy

# Branch predictor - keep for accuracy
[perf_model/branch_predictor]
type = pentium_m
mispredict_penalty = 16
size = 4096

# TLB - keep for accuracy
[perf_model/tlb]
penalty = 30
penalty_parallel = true

# DRAM - keep accurate modeling
[perf_model/dram]
type = constant
latency = 80
per_controller_bandwidth = 25.6
num_controllers = -1
controllers_interleaving = 8
controller_positions = ""
direct_access = false

[perf_model/dram/normal]
standard_deviation = 0

[perf_model/dram/cache]
enabled = false

[perf_model/dram/queue_model]
enabled = true
type = history_list

# DRAM directory - keep for accuracy
[perf_model/dram_directory]
total_entries = 1048576
associativity = 16
max_hw_sharers = 64
directory_type = full_map
home_lookup_param = 6
directory_cache_access_time = 10
locations = dram
interleaving = 1

[perf_model/dram_directory/limitless]
software_trap_penalty = 200

# Network configuration
[network]
memory_model_1 = emesh_hop_counter
system_model = emesh_hop_counter
collect_traffic_matrix = false

[network/emesh_hop_counter]
link_bandwidth = 128
hop_latency = 1

# Cache coherence - keep for accuracy
[caching_protocol]
type = parametric_dram_directory_msi
variant = mesi

# DVFS configuration
[dvfs]
type = simple
transition_latency = 1000

[dvfs/simple]
cores_per_socket = 64

# Disable complex features for speed
[bbv]
sampling = 0

[loop_tracer]
iter_start = 0
iter_count = 36

[osemu]
pthread_replace = false
clock_replace = true
nprocs = 0
time_start = 1337000000

